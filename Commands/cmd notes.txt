cd  C:\r\me\monitoring-trains

pip install ultralytics

https://stackoverflow.com/questions/9727688/how-to-get-the-cuda-version
nvcc --version
nvidia-smi

conda create --name python-312 --clone base
conda activate python-312

conda list cudatoolkit
conda list cudnn
conda install -c anaconda cudatoolkit
conda install -c anaconda cudnn

pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu126
pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu128

pip install tensorflow


python3 -m venv yolo-v5
danbitter@raspberrypi:~/repos/yolov5 $ source yolo-v5/bin/activate

C:\r\me\monitoring-trains\Test Data - 1 2 3 4 5 6.mp4

git clone --branch v6.1 https://github.com/ultralytics/yolov5.git
pip install -r requirements.txt

python detect.py --weights yolov5n.pt --source C:\r\me\monitoring-trains\6-trains.mp4 --classes 7 --save-txt --save-conf
pip uninstall torch

conda create -n yolov5-1.10 python=3.9 -y
cd C:\r\me\monitroing-trains
conda activate yolov5-1.10
pip install torch==1.10.0+cpu torchvision==0.11.1+cpu -f https://download.pytorch.org/whl/torch_stable.html
pip install -r requirements.txt
python detect.py --weights yolov5n.pt --source C:\r\me\monitoring-trains\6-trains.mp4 --classes 7 --save-txt --save-conf

python train.py --img 640 --batch 16 --epochs 100 --data C:\r\me\monitoring-trains\dataset\Railroad_Car_Detection.v13-yolov8n-v2.yolov5pytorch\data.yaml --weights yolov5n.pt --name railroad_detector
python train.py --img 640 --batch 16 --epochs 100 --data ..\dataset\Railroad_Car_Detection.v13-yolov8n-v2.yolov5pytorch\data.yaml --weights yolov5n.pt --name railroad_detector
python train.py --img 640 --batch 16 --epochs 100 --data ../dataset/Railroad_Car_Detection.v13-yolov8n-v2.yolov5pytorch/data.yaml --weights yolov5n.pt --name railroad_detector

python yolov5\train.py --img 640 --batch 16 --epochs 100 --data dataset\Railroad_Car_Detection.v13-yolov8n-v2.yolov5pytorch\data.yaml --weights yolov5n.pt --name railroad_detector

pip install numpy==1.24.4 --force-reinstall
pip install pillow==9.5.0 --force-reinstall

cd c:\r\me\monitoring-trains\yolov5
python train.py --img 640 --batch 16 --epochs 100 --data ..\dataset\Railroad_Car_Detection.v13-yolov8n-v2.yolov5pytorch\data.yaml --weights yolov5n.pt --name railroad_detector

python detect.py --weights runs/train/train_detector/weights/best.pt --source your_video.mp4 --conf 0.25


-----------------------

Digital Ocean VM

sudo apt update
sudo apt install python3-venv python3-full
python3 -m venv trains
source trains/bin/activate

git clone https://github.com/ultralytics/yolov5
git clone --branch v6.1 https://github.com/ultralytics/yolov5.git
cd yolov5
pip install -r requirements.txt

root
99494baf0e277b985d929426f6
monitoring

scp -i C:\r\me\monitoring-trains\monitoring-trains-key-openssh -P 22 C:\r\me\monitoring-trains\yolov5\weights\yolov5n-v6.1.pt root@143.198.47.2:/root/weights/yolov5n-v6.1.pt
scp -i C:\r\me\monitoring-trains\monitoring-trains-key-openssh -P 22 C:\r\me\monitoring-trains\dataset\Railroad_Car_Detection.v13-yolov8n-v2.yolov5pytorch\Railroad_Car_Detection.v13-yolov8n-v2.yolov5pytorch.zip root@143.198.47.2:/root/Railroad_Car_Detection.v13-yolov8n-v2.yolov5pytorch.zip
apt-get install unzip

python train.py --img 640 --batch 16 --epochs 100 --data ../dataset/railroad-cars/data.yaml --weights ../weights/yolov5n-v6.1.pt --name railroad_detector

scp -i C:\r\me\monitoring-trains\monitoring-trains-key-openssh -P 22 -r root@143.198.47.2:/root/yolov5/runs/train/railroad_detector .

git clone https://github.com/BitterDone/yolov5-6.1.git
cd yolov5-6_1
pip install -r requirements.txt

downgrade python from 3.10 to 3.9

pip uninstall torch -y
then either
    pip install torch==1.10.0+cpu torchvision==0.11.1+cpu -f https://download.pytorch.org/whl/cpu/torch_stable.html
    ERROR: No matching distribution found for torch==1.10.0+cpu

or
    pip install https://download.pytorch.org/whl/cpu/torch-1.10.0%2Bcpu-cp39-cp39-win_amd64.whl
    pip install https://download.pytorch.org/whl/cpu/torchvision-0.11.1%2Bcpu-cp39-cp39-win_amd64.whl
    ERROR: torch-1.10.0+cpu-cp39-cp39-win_amd64.whl is not a supported wheel on this platform.



python train.py --img 640 --batch 16 --epochs 100 --data railroad-cars/data.yaml --weights weights/yolov5n-v6_1.pt --name railroad_detector


---------------
Steps for new Ubuntu VM

sudo apt-get -y remove -y --purge python3
sudo -y apt-get -y autoremove

curl -fsSL https://pyenv.run | bash
echo 'export PYENV_ROOT="$HOME/.pyenv"' >> ~/.bashrc
echo '[[ -d $PYENV_ROOT/bin ]] && export PATH="$PYENV_ROOT/bin:$PATH"' >> ~/.bashrc
echo 'eval "$(pyenv init - bash)"' >> ~/.bashrc

echo 'export PYENV_ROOT="$HOME/.pyenv"' >> ~/.profile
echo '[[ -d $PYENV_ROOT/bin ]] && export PATH="$PYENV_ROOT/bin:$PATH"' >> ~/.profile
echo 'eval "$(pyenv init - bash)"' >> ~/.profile

exec "$SHELL"

sudo apt update; sudo apt install -y make build-essential libssl-dev zlib1g-dev \
libbz2-dev libreadline-dev libsqlite3-dev curl git \
libncursesw5-dev xz-utils tk-dev libxml2-dev libxmlsec1-dev libffi-dev liblzma-dev

pyenv install 3.9.0 
pyenv global 3.9.0

git clone https://bitterdone:<token>@github.com/BitterDone/yolov5-6.1.git
cd yolov5-6_1
pip install -r requirements.txt

pip uninstall torch -y
pip install torch==1.10.0+cpu torchvision==0.11.1+cpu -f https://download.pytorch.org/whl/cpu/torch_stable.html

pip install numpy==1.24.4 --force-reinstall

pip install numpy==1.24.4

ERROR: After October 2020 you may experience errors when installing or updating packages. This is because pip will change the way that it resolves dependency conflicts.
We recommend you use --use-feature=2020-resolver to test your packages with the new resolver before it becomes the default.
opencv-python 4.12.0.88 requires numpy<2.3.0,>=2; python_version >= "3.9", but you'll have numpy 1.24.4 which is incompatible.

pip install opencv-python==4.5.5.64
pip install pillow==9.5.0 --force-reinstall

python train.py --img 640 --batch 16 --epochs 100 --data railroad-cars/data.yaml --weights weights/yolov5n-v6_1.pt --name railroad_detector

sh backup-model-vm.sh
sudo find / -type f -name "model_export.*" 2>/dev/null

cd c:\r\me\monitoring-trains
scp -i C:\r\me\monitoring-trains\monitoring-trains-key-openssh root@167.99.182.230:/root/model_export.zip .

Snapshot
monitoring-trains-model-trained

-----------------------
2025-09-02 Before Demo

python detect.py --weights yolov5n.pt                                       --source C:\r\me\monitoring-trains\6-trains.mp4 --classes 7 --save-txt --save-conf
python detect.py --weights /runs/train/railroad_detector7/weights/best.pt   --source C:\r\me\monitoring-trains\6-trains.mp4 --classes 7 --save-txt --save-conf

sudo find / -type f -name "model_export.*" 2>/dev/null

scp -i C:\r\me\monitoring-trains\monitoring-trains-key-openssh root@159.203.22.96:/root/model_export.tar.gz .
scp -i C:\r\me\monitoring-trains\monitoring-trains-key-openssh C:\r\me\monitoring-trains\6-trains.mp4 root@159.203.22.96:/root/monitoring-trains/yolov5-6.1/videos
scp -i C:\r\me\monitoring-trains\monitoring-trains-key-openssh root@159.203.22.96:/root/model_export.zip .
